<!-- pages/home/home.wxml - ä¼˜åŒ–ç‰ˆ -->
<view class="home-page {{isPatient ? 'patient-theme' : 'caregiver-theme'}}">
  <view wx:if="{{loading}}" class="loading-center">åŠ è½½ä¸­...</view>

  <view wx:else>
    <!-- é¡¶éƒ¨é—®å€™ï¼ˆåŠ¨æ€ï¼‰ -->
    <view class="greeting">
      <text class="greeting-text">{{greetingText}}</text>
      <text class="greeting-sub" wx:if="{{cycleNo > 0}}">
        ç¬¬{{cycleNo}}ç–—ç¨‹ Â· Day {{cycleDay}}
      </text>
    </view>

    <!-- ç–—ç¨‹é˜¶æ®µæç¤º -->
    <view class="cycle-hint" wx:if="{{cycleDayLabel}}">
      <text>{{cycleDayLabel}}</text>
    </view>

    <!-- â•â• æ‚£è€…ï¼šä»Šæ—¥çŠ¶æ€å¡ç‰‡ â•â• -->
    <view wx:if="{{isPatient}}" class="card status-card">
      <text class="status-emoji">{{statusEmoji}}</text>
      <text class="status-text">{{statusText}}</text>

      <!-- æœªè®°å½• -->
      <view wx:if="{{!hasRecorded}}" class="action-btns">
        <button class="btn-primary" bindtap="goRecord">ğŸ“ å¼€å§‹è®°å½•</button>
        <button class="btn-quick" bindtap="showQuickTemp">ğŸŒ¡ï¸ åªè®°ä½“æ¸©</button>
      </view>

      <!-- å·²è®°å½•ï¼šæ˜¾ç¤ºé¼“åŠ±ï¼Œä¸æ˜¾ç¤ºå†°å†·æ•°å€¼ -->
      <view wx:else class="encourage-section">
        <text class="encourage-text">{{encourageText}}</text>
        <view class="recorded-actions">
          <button class="btn-outline modify-btn" bindtap="goRecord">æŸ¥çœ‹ / ä¿®æ”¹</button>
        </view>
      </view>
    </view>

    <!-- â•â• å®¶å±ï¼šä»Šæ—¥çŠ¶æ€å¡ç‰‡ â•â• -->
    <view wx:if="{{!isPatient}}" class="card status-card">
      <text class="status-emoji">{{statusEmoji}}</text>
      <text class="status-text">{{statusText}}</text>

      <view wx:if="{{!hasRecorded}}" class="action-btns">
        <button class="btn-primary" bindtap="goRecord">ğŸ“ ä»£å¡«è®°å½•</button>
      </view>

      <view wx:else class="recorded-info">
        <view class="info-grid">
          <view class="info-item" wx:if="{{todayLog.energy != null}}">
            <text class="info-icon">ğŸ’ª</text>
            <text class="info-value">{{todayLog.energy}}/4</text>
            <text class="info-label">ä½“åŠ›</text>
          </view>
          <view class="info-item" wx:if="{{todayLog.nausea != null}}">
            <text class="info-icon">ğŸ¤¢</text>
            <text class="info-value">{{todayLog.nausea}}/3</text>
            <text class="info-label">æ¶å¿ƒ</text>
          </view>
          <view class="info-item" wx:if="{{todayLog.stool_count != null}}">
            <text class="info-icon">ğŸš½</text>
            <text class="info-value">{{todayLog.stool_count}}æ¬¡</text>
            <text class="info-label">æ’ä¾¿</text>
          </view>
          <view class="info-item" wx:if="{{todayLog.fever}}">
            <text class="info-icon">ğŸŒ¡ï¸</text>
            <text class="info-value">{{todayLog.temp_c}}â„ƒ</text>
            <text class="info-label">ä½“æ¸©</text>
          </view>
        </view>
        <button class="btn-outline modify-btn" bindtap="goRecord">ä¿®æ”¹è®°å½•</button>
      </view>
    </view>

    <!-- æ‚£è€…ï¼šæ’ä¾¿æµ®åŠ¨æŒ‰é’® -->
    <view wx:if="{{isPatient}}" class="fab" bindtap="goStool">
      <text>ğŸš½</text>
    </view>

    <!-- å®¶å±ï¼šå¿«æ·å…¥å£ -->
    <view wx:if="{{!isPatient}}" class="quick-actions">
      <view class="quick-item" bindtap="goSummary">
        <text class="quick-icon">ğŸ“‹</text>
        <text class="quick-label">å°±è¯Šæ‘˜è¦</text>
      </view>
      <view class="quick-item" bindtap="goRecord">
        <text class="quick-icon">âœï¸</text>
        <text class="quick-label">ä»£å¡«è®°å½•</text>
      </view>
    </view>
  </view>

  <!-- â•â• å¿«é€Ÿä½“æ¸©å¼¹çª— â•â• -->
  <view wx:if="{{showQuickTemp}}" class="overlay" bindtap="hideQuickTemp">
    <view class="quick-modal" catchtap="">
      <text class="quick-modal-title">ğŸŒ¡ï¸ å¿«é€Ÿè®°ä½“æ¸©</text>
      <text class="quick-modal-desc">å…¶ä»–é¡¹ç›®ä¼šç”¨æ˜¨å¤©çš„æ•°æ®è‡ªåŠ¨å¡«å……</text>

      <view class="quick-temp-row">
        <input
          type="digit"
          placeholder="36.5"
          value="{{quickTempValue}}"
          bindinput="onQuickTempInput"
          class="quick-temp-input"
          focus="{{showQuickTemp}}"
        />
        <text class="quick-temp-unit">â„ƒ</text>
      </view>

      <button
        class="btn-primary quick-save-btn"
        bindtap="onQuickTempSave"
        loading="{{quickSaving}}"
        disabled="{{quickSaving}}"
      >è®°å½•</button>

      <view class="quick-cancel" bindtap="hideQuickTemp">
        <text>å–æ¶ˆ</text>
      </view>
    </view>
  </view>
</view>
